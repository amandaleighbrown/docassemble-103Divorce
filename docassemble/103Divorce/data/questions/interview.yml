---
include:
  - docassemble.AssemblyLine:al_package.yml
  - docassemble.ALGenericJurisdiction:custom_organization.yml
---
metadata:
  title: |
    103 Petition for Divorce - No Children
  short title: |
    103 Petition for Divorce - No Children
  tags:
    - FA-00-00-00-00
---
mandatory: True
comment: |
  This contains metadata that will not be overwritten if this YAML file is included in another
  file. Each file gets its own key in the interview_metadata dictionary.
  Most keys are not currently used at runtime, other than "allowed courts".
code: |
  interview_metadata
  if not defined("interview_metadata['_Divorce_No_Children']"):
    interview_metadata.initializeObject("_Divorce_No_Children")
    interview_metadata["_Divorce_No_Children"].update({
      "al_weaver_version": "1.0.2",
      "generated on": "2021-06-07",
      "title": "103 Petition for Divorce - No Children",
      "short title": "103 Petition for Divorce - No Children",
      "description": "103 Petition for Divorce - No Children",
      "original_form": "https://www.lsba.org/documents/ATJPublicResources/SRLDivorcePetitionNoMinorChildren.pdf",
      "allowed courts": [
        "Louisiana Judicial District Courts",
      ],
      "categories": [
        "FA-00-00-00-00",
      ],        
      "logic block variable": "interview_order__Divorce_No_Children",
      "attachment block variable": "_Divorce_No_Children_attachment",
      "typical role": "plaintiff",
    })
---
code: |
  interview_short_title = "Ask the court for an Article 103 divorce"
---
code: |
  al_form_type = 'starts_case'
---
objects:
  - users: ALPeopleList.using(ask_number=True,target_number=1)
  - court_list: ALCourtLoader.using(file_name='JDCs_by_Parish.csv')
  - other_parties: ALPeopleList.using(ask_number=True,target_number=1)
---
sections:
  - review__Divorce_No_Children: Review your answers
---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order__Divorce_No_Children
code: |
  # Set the allowed courts for this interview
  allowed_courts = interview_metadata["_Divorce_No_Children"]["allowed courts"]
  nav.set_section('review__Divorce_No_Children')
  user_role = 'plaintiff'
  Info_Required
  if both_live_in_louisiana:
    married_in_louisiana
    if married_in_louisiana:
        qualifies_to_continue
    else: final_screen
  else: final_screen
  petitioners.gather()
  users[0].address.address
  respondents.gather()
  respondents[0].address.address
  marriage_date
  set_progress(14.29)
  trial_court_index
  interview_order__Divorce_No_Children = True
---
###################### Main order ######################
comment: |
  This block includes the logic for standalone interviews.
  Delete mandatory: True to include in another interview
mandatory: True
code: |
  al_intro_screen
  _Divorce_No_Children_intro
  interview_order__Divorce_No_Children
  trial_court
  signature_date
  # Save anonymized interview statistics (customize the saved data below)
  store_variables_snapshot(data={'zip': users[0].address.zip})
  _Divorce_No_Children_preview_question
  basic_questions_signature_flow
  _Divorce_No_Children_download
---
comment: |
  This question is used to introduce your interview. Please customize
id: _Petition_for_Divorce__No_Children
continue button field: _Divorce_No_Children_intro
question: |
  Petition for Article 103 Divorce (No Children)
subquestion: |
  This form builder helps you complete the paperwork required for a Louisiana Article 103 Divorce when the parties have no children.
  
  **You should only use this form builder if:**
  
    * You and your spouse were married in Louisiana, **and**
    * You and your spouse both live in Louisiana, **and**
    * You and your spouse do not have children together under age 18 and are not currently pregnant, **and**
    * You and your spouse have been living separate and apart for at least 180 days without getting back together (called "reconciling").
---
id: Info_Required
question: |
  What do you need to get started?
subquestion: | 
  You need the following pieces of information to complete this form:
  
  * Date you were married
  * Date you were separated
  * An address where your spouse can be served (typically at home or work)

continue button field: Info_Required
---
id: Spouses were married in Louisiana
question: |
  First, let's make sure you qualify to use this form builder.
fields:  
  - "Were you and your spouse married in Louisiana?": married_in_louisiana
    datatype: yesnoradio
  - "Do both you and your spouse live in Louisiana?": both_live_in_louisiana
    datatype: yesnoradio
  - "Do you and your spouse have children together under the age of 18, or are you pregnant?": has_minor_children
    datatype: yesnoradio
---
question: | 
  Great! It looks like you qualify to use this form builder. 
continue button field: qualifies_to_continue
---
mandatory: True
event: final_screen
code:  |
  if both_live_in_louisiana == 'false':
    final_screen
---
question: |
  Sorry, you don't qualify to use this app.
event: final_screen
---
id: Marriage Date
question: |
  About your marriage to ${ respondents[0] }
fields:
  - "When did you and ${ respondents[0].name.first } get married?": marriage_date
    datatype: date  
  - "In what parish did you and ${ respondents[0].name.first } get married?": marriage_parish
    maxlength: 16
  - "In what parish did you and ${ respondents[0].name.first } last live together?": marital_domicile_parish
  - "When did you and ${ respondents[0].name.first } begin living separate and apart?": separation_date
    datatype: date
---
id: your name
sets:
    - users[0].name.first
    - users[0].name.last
question:  |
  What is your name?
subquestion: |
  Do not use any nicknames, only your full legal name.
fields:
  - code: |
      users[0].name_fields()
---
id: your address
sets:
  - users[0].address.address
  - users[0].address.city
  - users[0].address.county
  - users[0].address.zip
question: |
  What is your address?
subquestion: |
  Use an address where you can be contacted.
fields:
  - code: |
      users[0].address_fields(country_code=AL_DEFAULT_COUNTRY, default_state=AL_DEFAULT_STATE)
  - Parish: users[0].address.county
---
sets: users[0].address.county
code: |
  users[0].address.geocode()
---
id: is there an opposing party?
code: |
  other_parties.there_are_any = "Yes"
---
sets:
  - other_parties[i].name.first
id: names of opposing parties
question: |
  What is your spouse's name?
subquestion: |
  Do not use any nicknames, only your spouse's full legal name.
fields:
  - code: |
      other_parties[i].name_fields(person_or_business='person') 
---
code: |
  AL_DEFAULT_COUNTRY = "US"
  AL_DEFAULT_STATE = "Louisiana"
---
sets:
  - other_parties[0].address.address
  - other_parties[0].address.city
  - other_parties[0].address.zip
id: persons address
question: |
  What is ${ other_parties[0].possessive('home address') }?
fields:
  - code: |
      other_parties[0].address_fields(country_code=AL_DEFAULT_COUNTRY, default_state=AL_DEFAULT_STATE)
  - Parish: other_parties[0].address.county
---
mandatory: True
sets: other_parties[0].address.county
code: |
  other_parties[0].address.geocode()
---
id: Final details
question: |
  Final details
fields:
  - "In what Parish will you file your divorce?": trial_court_index
    code: |
      court_list.filter_courts(None)
    help: |
      Filing your paperwork with the right court is important. These are the options for Louisiana residents filing for divorce:
      1. Where you currently live (${ users[0].address.county });
      2. Where your spouse currently lives (${ respondents[0].address.county }); 
      3. Where you and your spouse last lived together (${ marital_domicile_parish }  Parish)
  - "Are you a female spouse seeking to revert back to your maiden name?": revert_to_maiden_name
    datatype: yesnoradio
  - "What is your maiden name?": maiden_name1
    show if: revert_to_maiden_name
  - "What is your telephone number? (format: (555) 555-5555)": petitioner_telephone
    maxlength: 19
---
code: |
  trial_court = court_list.as_court('trial_court', trial_court_index)
---
id: preview _Divorce_No_Children
question: |
  Preview your form before you sign it
subquestion: |
  Here is a preview of the form you will sign on the next page.   
  
  ${ al_court_bundle.as_pdf(key='preview') }

  Click the image to open it in a new tab. Click the "Make changes" button
  to edit your answers.

  ${ action_button_html(url_action('review__Divorce_No_Children'), label='Make changes', color='info') }
  
  Remember to come back to this window to continue and sign your form.
continue button field: _Divorce_No_Children_preview_question    
---
code: |
  signature_fields = ["users[0].signature"]
---
id: Divorce No Children review screen
skip undefined: True
event: review__Divorce_No_Children
question: |
  Review your answers
review:
  - Edit: trial_court.name
    button: |
      **In what parish will you file your divorce?**:
      ${ trial_court.name }
  - Edit: users[0].address.county
    button: |
      **In what parish do you currently live?**:
      ${ users[0].address.county.replace(" Parish", "") }
  - Edit: respondents[0].address.county
    button: |
      **In what parish does the other party live?**:
      ${ respondents[0].address.county.replace(" Parish", "") }
  - Edit: marriage_date
    button: |
      **When were you and your spouse married?**:
      ${ marriage_date }
  - Edit: marriage_parish
    button: |
      **In what parish were you married?**:
      ${ marriage_parish }
  - Edit: separation_date
    button: |
      **When did you separate from your spouse?**:
      ${ separation_date }
  - Edit: maiden_name1
    button: |
      **What is your maiden name?**:
      ${ maiden_name1 }
    show if: revert_to_maiden_name
  - Edit: users[0].signature
    button: |
      **Sign Here:**:
      ${ showifdef(users[0].signature) }
  - Edit: petitioner_telephone
    button: |
      **What is your telephone number?**:
      ${ petitioner_telephone }
  - Edit: respondents[0].address.address
    button: |
      **What is the other party's address?**:
      ${ respondents[0].address.on_one_line() }
  - Edit: petitioners[0].address.county
    button: |
      **In what parish do you currently live?**:
      ${ users[0].address.county.replace(" Parish", "") }
  - Edit: petitioners.revisit
    button: |
      **petitioners**

      % for item in petitioners:
        * ${ item }
      % endfor
  - Edit: respondents.revisit
    button: |
      **respondents**

      % for item in respondents:
        * ${ item }
      % endfor
---
continue button field: petitioners.revisit
question: |
  Edit petitioners
subquestion: |
  ${ petitioners.table }

  ${ petitioners.add_action() }
---
table: petitioners.table
rows: petitioners
columns:
  - name: |
      row_item.name.full() if defined("row_item.name.first") else ""
  - address: |
      row_item.address.block() if defined("row_item.address.address") else ""
edit:
  - name.first
  - address.address
confirm: True

---
continue button field: respondents.revisit
question: |
  Edit respondents
subquestion: |
  ${ respondents.table }

  ${ respondents.add_action() }
---
table: respondents.table
rows: respondents
columns:
  - name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True

---
id: download _Divorce_No_Children
event: _Divorce_No_Children_download
question: |
  Your form is ready to download.
subquestion: |
  Thank you ${users}. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Make changes" button to fix any mistakes.

  ${ action_button_html(url_action('review__Divorce_No_Children'), label='Make changes', color='info') }
  
  
  ${ al_user_bundle.download_list_html() }
  

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }

progress: 100
---
objects:
  - Post_interview_instructions: ALStaticDocument.using(title="Instructions", filename="103_Petition_for_Divorce_-_No_Children.pdf", enabled=True, has_addendum=False)
  - _Divorce_No_Children_attachment: ALDocument.using(title="103 Petition for Divorce - No Children", filename="103_Petition_for_Divorce_-_No_Children.pdf", enabled=True, has_addendum=False)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[_Divorce_No_Children_attachment], filename="_Divorce_No_Children_package.pdf", title="All forms to download for your records")
  - al_court_bundle: ALDocumentBundle.using(elements=[_Divorce_No_Children_attachment], filename="_Divorce_No_Children_package.pdf", title="All forms to download for your records")
---
attachments:
  - name:  Divorce No Children attachment
    filename: _Divorce_No_Children     
    variable name: _Divorce_No_Children_attachment[i]        
    skip undefined: True
    pdf template file: 103_Petition_for_Divorce_-_No_Children.pdf
    fields:
      - "petitioner1": ${ petitioners[0] }
      - "respondent1": ${ respondents[0] }
      - "petitioner2": ${ petitioners[0] }
      - "respondent2": ${ respondents[0] }
      - "petitioner3": ${ petitioners[0] }
      - "petitioner_address_on_one_line": ${ petitioners[0].address.on_one_line() }
      - "petitioner_address_on_one_line2": ${ petitioners[0].address.on_one_line() }
      - "respondent_address": ${ respondents[0].address.on_one_line() }
      - "petitioner4": ${ petitioners[0] }
      - "respondent3": ${ respondents[0] }
      - "petitioner5": ${ petitioners[0] }
      - "respondent4": ${ respondents[0] }
      - "petitioner6": ${ petitioners[0] }
      - "respondent5": ${ respondents[0] }
      - "petitioner7": ${ petitioners[0] }
      - "petitioner9": ${ petitioners[0] }
      - "respondent6": ${ respondents[0] }
      - "petitioner10": ${ petitioners[0] }
      - "petitioner11": ${ petitioners[0] }
      - "respondent7": ${ respondents[0] }
      - "petitioner12": ${ petitioners[0] }
      - "petitioner13": ${ petitioners[0] }
      - "respondent8": ${ respondents[0] }
      - "judicial_district1": ${ trial_court.judicial_district }
      - "filing_parish1": ${ trial_court.name }
      - "user_domicile": ${ users[0].address.county.replace(" Parish", "") }
      - "respondent_domicile1": ${ respondents[0].address.county.replace(" Parish", "") }
      - "marriage_year1": ${ marriage_date.year }
      - "marriage_month1": ${ marriage_date.format("MMMM") }
      - "marriage_day1": ${ ordinal_number(marriage_date.day,use_word=False) }
      - "marriage_parish": ${ marriage_parish }
      - "separation_day1": ${ ordinal_number(separation_date.day,use_word=False) }
      - "separation_month1": ${ separation_date.format("MMMM") }
      - "separation_year1": ${ separation_date.year }
      - "maiden_name1": ${ maiden_name1 }
      - "user_signature": ${ users[0].signature if i == 'final' else '' }
      - "petitioner_telephone": ${ petitioner_telephone }
      - "judicial_district2": ${ trial_court.judicial_district }
      - "filing_parish2": ${ trial_court.name }
      - "respondent_address": ${ respondents[0].address.on_one_line() }
      - "judicial_district3": ${ trial_court.judicial_district }
      - "filing_parish3": ${ trial_court.name }
      - "judicial_district4": ${ trial_court.judicial_district }
      - "filing_parish5": ${ trial_court.name }
      - "petitioner_domicile": ${ users[0].address.county.replace(" Parish", "") }
      - "respondent_domicile2": ${ respondents[0].address.county.replace(" Parish", "") }
      - "marriage_month2": ${ marriage_date.format("MMMM") }
      - "marriage_year2": ${ marriage_date.year }
      - "marriage_day2": ${ ordinal_number(marriage_date.day,use_word=False) }
      - "separation_day2": ${ ordinal_number(separation_date.day,use_word=False) }
      - "separation_month2": ${ separation_date.format("MMMM") }
      - "separation_year2": ${ separation_date.year }
      - "judicial_district5": ${ trial_court.judicial_district }
      - "filing_parish6": ${ trial_court.name }
      - "maiden_name2": ${ maiden_name1 }
      - "respondent_domicile1": ${ respondents[0].address.county.replace(" Parish", "") }
      - "respondent_domicile2": ${ respondents[0].address.county.replace(" Parish", "") }

      

