#commit notes: 
---
include:
  - docassemble.AssemblyLine:al_package.yml
  - docassemble.ALLouisianaSC:custom_organization.yml
  - docassemble.EFSPIntegration:efiling_integration.yml
---
#modules:
#  - .progressivedisclosure
#---
#features:
#  css: progressivedisclosure.css
#---
metadata:
  title: |
    103 Petition for Divorce - No Children
  short title: |
    103 Petition for Divorce - No Children
  tags:
    - FA-00-00-00-00
---
mandatory: True
comment: |
  This contains metadata that will not be overwritten if this YAML file is included in another
  file. Each file gets its own key in the interview_metadata dictionary.
  Most keys are not currently used at runtime, other than "allowed courts".
code: |
  interview_metadata
  if not defined("interview_metadata['_Divorce_No_Children']"):
    interview_metadata.initializeObject("_Divorce_No_Children")
    interview_metadata["_Divorce_No_Children"].update({
      "al_weaver_version": "1.0.2",
      "generated on": "2021-06-07",
      "title": "103 Petition for Divorce - No Children",
      "short title": "103 Petition for Divorce - No Children",
      "description": "103 Petition for Divorce - No Children",
      "original_form": "https://www.lsba.org/documents/ATJPublicResources/SRLDivorcePetitionNoMinorChildren.pdf",
      "allowed courts": [
        "Louisiana Judicial District Courts",
      ],
      "categories": [
        "FA-00-00-00-00",
      ],        
      "logic block variable": "interview_order__Divorce_No_Children",
      "attachment block variable": "_Divorce_No_Children_attachment",
      "typical role": "plaintiff",
    })
---
code: |
  interview_short_title = "Ask the court for an Article 103 divorce"
---
code: |
  al_form_type = 'starts_case'
  efile_author_mode = False
  proxy_conn = ProxyConnection(credentials_code_block=None)
---
code: |
  jurisdiction_id = 'louisiana'
---
objects:
  - users: ALPeopleList.using(ask_number=True,target_number=1)
  - court_list: ALCourtLoader.using(file_name='JDCs_by_Parish.csv')
  - other_parties: ALPeopleList.using(ask_number=True,target_number=1)
---
sections:
  - review__Divorce_No_Children: Review your answers
---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order__Divorce_No_Children
code: |
  # Set the allowed courts for this interview
  allowed_courts = interview_metadata["_Divorce_No_Children"]["allowed courts"]
  nav.set_section('review__Divorce_No_Children')
  user_role = 'plaintiff'
  Info_Required
  married_in_louisiana
  if qualifies_to_continue:
    qualifies_to_continue_screen
  else: final_screen
  petitioners.gather()
  users[0].address.address
  respondents.gather()
  respondents[0].address.address
  marriage_date
  set_progress(14.29)
  trial_court_index
  interview_order__Divorce_No_Children = True
---
###################### Main order ######################
comment: |
  This block includes the logic for standalone interviews.
  Delete mandatory: True to include in another interview
mandatory: True
code: |
  al_intro_screen
  _Divorce_No_Children_intro
  interview_order__Divorce_No_Children
  trial_court
  can_check_efile
  signature_date
  # Save anonymized interview statistics (customize the saved data below)
  store_variables_snapshot(data={'zip': users[0].address.zip})
  if can_check_efile:
    users[0].email
    lead_contact = users[0]
    ready_to_efile
  _Divorce_No_Children_preview_question
  basic_questions_signature_flow
  _Divorce_No_Children_download
---
comment: |
  This question is used to introduce your interview. Please customize
id: _Petition_for_Divorce__No_Children
continue button field: _Divorce_No_Children_intro
question: |
  Petition for Article 103 Divorce (No Children)
subquestion: |
  This form builder helps you complete the paperwork required for a Louisiana Article 103 Divorce when the parties have no children.
  
  **You should only use this form builder if:**
  
    * You and your spouse were married in Louisiana, **and**
    * You and your spouse both live in Louisiana, **and**
    * You and your spouse do not have children together under age 18 and are not currently pregnant, **and**
    * You and your spouse have been living separate and apart for at least 180 days without getting back together (called "reconciling").
    
  **You cannot use these forms if your spouse is on active duty with the Armed Forces of the United States or any of its allies.**
---
id: Info_Required
question: |
  What do you need to get started?
subquestion: | 
  You need the following pieces of information to complete this form:
  
  * Date you were married
  * Date you were separated
  * An address where your spouse can be served (typically at home or work, but we'll give you more information later that can help you choose.)

continue button field: Info_Required
---
id: Qualifying questions
question: |
  First, let's make sure you qualify to use this form builder.
fields:  
  - "Were you and your spouse married in Louisiana?": married_in_louisiana
    datatype: yesnoradio
  - "Do both you and your spouse live in Louisiana?": both_live_in_louisiana
    datatype: yesnoradio
  - "Do you have children under the age of 18 with your spouse, or are you/they currently pregnant?": has_minor_children
    datatype: yesnoradio
  - "Is your spouse on active duty with the United States Armed Forces or any of its allies?": active_duty_spouse
    datatype: yesnoradio
---
id: Marriage Date
question: |
  About your marriage to ${ respondents[0] }
fields:
  - "When did you and ${ respondents[0].name.first } get married?": marriage_date
    datatype: date
    max: ${ today() }
  - "In what parish did you and ${ respondents[0].name.first } get married?": marriage_parish
    maxlength: 20
  - "In what parish did you and ${ respondents[0].name.first } last live together?": marital_domicile_parish
  - "When did you and ${ respondents[0].name.first } begin living separate and apart?": separation_date
    datatype: date
---
id: qualifies_to_continue
code: |
  qualifies_to_continue = married_in_louisiana and both_live_in_louisiana and has_minor_children != True and active_duty_spouse != True
---
id: Final Screen for Non-Qualifiers
question: |
  Sorry, you don't qualify to use this app. 
event: final_screen
---
question: | 
  Great! It looks like you qualify to use this form builder. 
continue button field: qualifies_to_continue_screen
---
id: your name
sets:
    - users[0].name.first
    - users[0].name.last
question:  |
  What is your name?
subquestion: |
  Do not use any nicknames, only your full legal name.
fields:
  - code: |
      users[0].name_fields()
---
id: your address
sets:
  - users[0].address.address
  - users[0].address.city
  - users[0].address.county
  - users[0].address.zip
question: |
  What is your address?
subquestion: |
  Use an address where you can be contacted.
fields:
  - code: |
      users[0].address_fields(country_code=AL_DEFAULT_COUNTRY, default_state=AL_DEFAULT_STATE)
  - Parish: users[0].address.county
---
sets: users[0].address.county
code: |
  users[0].address.geocode()
---
id: is there an opposing party?
code: |
  other_parties.there_are_any = "Yes"
---
sets:
  - other_parties[i].name.first
id: names of opposing parties
question: |
  What is your spouse's name?
subquestion: |
  Do not use any nicknames, only your spouse's full legal name.
fields:
  - code: |
      other_parties[i].name_fields(person_or_business='person') 
---
code: |
  AL_DEFAULT_COUNTRY = "US"
  AL_DEFAULT_STATE = "Louisiana"
---
sets:
  - other_parties[0].address.address
  - other_parties[0].address.city
  - other_parties[0].address.zip
id: service address
question: |
  Where will you have ${ other_parties[0].name.first } served?
subquestion: |
  ${ collapse_template(service_options_explanation) }
  &nbsp;
fields:
  - code: |
      other_parties[0].address_fields(country_code=AL_DEFAULT_COUNTRY, default_state=AL_DEFAULT_STATE)
  - Parish: other_parties[0].address.county
  - "Is this ${ other_parties[0].name.first }'s home address?": domiciliary_service
    datatype: yesnoradio
  - "What is ${ other_parties[0].name.first }'s home parish?": home_parish
    show if: 
      variable: domiciliary_service
      is: False

---
mandatory: True
sets: other_parties[0].address.county
code: |
  other_parties[0].address.geocode()
---
id: Final details
question: |
  Final details
subquestion: |
  ${ collapse_template(court_choices_explanation) }
  &nbsp;
fields:
  - "In what Parish will you file your divorce?": trial_court_index
    code: |
      court_list.filter_courts(None)
  - "Would you like to go back to a pre-marriage last name?": revert_to_maiden_name
    datatype: yesnoradio
  - "What last name would you like to go back to?": maiden_name1
    show if: revert_to_maiden_name
  - "What is your telephone number? (format: (555) 555-5555)": petitioner_telephone
    maxlength: 19
  - "What is your e-mail address?": petitioner_email
---
template: court_choices_explanation
subject: |
  ðŸ’¡ What are my court options?
content: | 
  Filing your paperwork with the right court is important. These are your options:
  
      1. The parish where you currently live (${ users[0].address.county } )
      2. The parish where ${ respondents[0].name.first } currently lives 
      3. The parish where you and ${ respondents[0].name.first } last lived together (${ marital_domicile_parish } Parish) 
---
template: service_options_explanation
subject: |
  ðŸ’¡ What are my options for serving ${ respondents[0].name.first }?
content: | 
  There are two types of service: "personal service" and "domiciliary service." You can use either to serve divorce papers.
  
  For personal service, ${ respondents[0].name.first } needs to be directly handed the divorce papers. This can happen wherever they can be physically found, including home, work, or a friend's house.
  
  For domiciliary service, the divorce papers must be served to "a person of suitable age and discretion" wherever ${ respondents[0].name.first } considers "home." Someone like a spouse, parent, or even an older, teenaged child would be ok.
---
template: change_maiden_name_clause_pleading
content: |
  % if revert_to_maiden_name:
  Petitioner wishes to have her name confirmed as ${ maiden_name1 }.
  % else:
  The petitioner does not require confirmation of a maiden name.
  % endif
---
template: change_maiden_name_clause_judgment
content: |
  % if revert_to_maiden_name:
  **IT IS FURTHER ORDERED, ADJUDGED, AND DECREED** that Petitioner's name is confirmed as %{ MAIDEN_NAME1 }, which is their maiden name.
  % else:
  ""
  % endif
---
code: |
  trial_court = court_list.as_court('trial_court', trial_court_index)
---
id: preview _Divorce_No_Children
question: |
  Preview your form before you sign it
subquestion: |
  Here is a preview of the form you will sign on the next page.   
  
  ${ al_court_bundle.as_pdf(key='preview') }

  Click the image to open it in a new tab. Click the "Make changes" button
  to edit your answers.

  ${ action_button_html(url_action('review__Divorce_No_Children'), label='Make changes', color='info') }
  
  Remember to come back to this window to continue and sign your form.
continue button field: _Divorce_No_Children_preview_question    
---
code: |
  signature_fields = ["users[0].signature"]
---
id: Divorce No Children review screen
skip undefined: True
event: review__Divorce_No_Children
question: |
  Review your answers
  % if defined('efile') and efile:
  ** WARNING**: your answers have already been e-filed. Changing these answers will not change your submitted answers.
  % endif
review:
  - Edit: trial_court.name
    button: |
      **In what parish will you file your divorce?**:
      ${ trial_court.name }
  - Edit: users[0].address.county
    button: |
      **In what parish do you currently live?**:
      ${ users[0].address.county.replace(" Parish", "") }
  - Edit: respondents[0].address.county
    button: |
      **In what parish does the other party live?**:
      ${ respondents[0].address.county.replace(" Parish", "") }
  - Edit: marriage_date
    button: |
      **When were you and your spouse married?**:
      ${ marriage_date }
  - Edit: marriage_parish
    button: |
      **In what parish were you married?**:
      ${ marriage_parish }
  - Edit: separation_date
    button: |
      **When did you separate from your spouse?**:
      ${ separation_date }
  - Edit: maiden_name1
    button: |
      **What is your maiden name?**:
      ${ maiden_name1 }
    show if: revert_to_maiden_name
  - Edit: users[0].signature
    button: |
      **Sign Here:**:
      ${ showifdef(users[0].signature) }
  - Edit: petitioner_telephone
    button: |
      **What is your telephone number?**:
      ${ petitioner_telephone }
  - Edit: petitioner_email
    button: |
      **What is your email address?**:
      ${ petitioner_email }
  - Edit: respondents[0].address.address
    button: |
      **What is the other party's address?**:
      ${ respondents[0].address.on_one_line() }
  - Edit: petitioners[0].address.county
    button: |
      **In what parish do you currently live?**:
      ${ users[0].address.county.replace(" Parish", "") }
  - Edit: petitioners.revisit
    button: |
      **Petitioners**

      % for item in petitioners:
        * ${ item }
      % endfor
  - Edit: respondents.revisit
    button: |
      **Respondents**

      % for item in respondents:
        * ${ item }
      % endfor
---
continue button field: petitioners.revisit
question: |
  Edit petitioners
subquestion: |
  ${ petitioners.table }

  ${ petitioners.add_action() }
---
table: users.table
rows: users 
columns:
  - name: |
      row_item.name.full() if defined("row_item.name.first") else ""
  - address: |
      row_item.address.block() if defined("row_item.address.address") else ""
edit:
  - name.first
  - address.address
confirm: True
---
continue button field: respondents.revisit
question: |
  Edit respondents
subquestion: |
  ${ respondents.table }

  ${ respondents.add_action() }
---
table: other_parties.table
rows: other_parties 
columns:
  - name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True

---
id: download _Divorce_No_Children
event: _Divorce_No_Children_download
question: |
  Your form is ready to download.
subquestion: |
  Thank you ${users}. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Make changes" button to fix any mistakes.

  ${ action_button_html(url_action('review__Divorce_No_Children'), label='Make changes', color='info') }
  
  % if ready_to_efile and not (defined('efile') and efile):
  Click the "E-file button below to e-file your form at ${ trial_court }.
  
  ${ action_button_html(url_ask([{'recompute': ['efile']}]), label='E-file', icon='file-export') }
  % endif
  
  ${ al_user_bundle.download_list_html() }
  

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }

progress: 100
---
objects:
  - Post_interview_instructions: ALStaticDocument.using(title="Instructions", filename="Self-Represented_Litigant_Petition_for_Divorce_No_Minor_Children._1", enabled=True, has_addendum=False)
  - _Divorce_No_Children_attachment: ALDocument.using(title="103 Petition for Divorce - No Children", filename="103_Petition_for_Divorce_-_No_Children.pdf", enabled=True, has_addendum=False)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[_Divorce_No_Children_attachment], filename="_Divorce_No_Children_package.pdf", title="All forms to download for your records")
  - al_court_bundle: ALDocumentBundle.using(elements=[_Divorce_No_Children_attachment], filename="_Divorce_No_Children_package.pdf", title="All forms to download for your records")
---
attachments:
  - name:  Divorce No Children attachment
    filename: _Divorce_No_Children     
    variable name: _Divorce_No_Children_attachment[i]        
    skip undefined: True
    docx template file: Self-Represented_Litigant_Petition_for_Divorce_No_Minor_Children.docx
    fields:
      - "petitioner1": ${ petitioners[0] }
      - "respondent1": ${ respondents[0] }
      - "petitioner2": ${ petitioners[0] }
      - "respondent2": ${ respondents[0] }
      - "petitioner3": ${ petitioners[0] }
      - "petitioner_address_on_one_line": ${ petitioners[0].address.on_one_line() }
      - "petitioner_address_on_one_line2": ${ petitioners[0].address.on_one_line() }
      - "respondent_address": ${ respondents[0].address.on_one_line() }
      - "petitioner4": ${ petitioners[0] }
      - "respondent3": ${ respondents[0] }
      - "petitioner5": ${ petitioners[0] }
      - "respondent4": ${ respondents[0] }
      - "petitioner6": ${ petitioners[0] }
      - "respondent5": ${ respondents[0] }
      - "petitioner7": ${ petitioners[0] }
      - "petitioner9": ${ petitioners[0] }
      - "respondent6": ${ respondents[0] }
      - "petitioner10": ${ petitioners[0] }
      - "petitioner11": ${ petitioners[0] }
      - "respondent7": ${ respondents[0] }
      - "petitioner12": ${ petitioners[0] }
      - "petitioner13": ${ petitioners[0] }
      - "respondent8": ${ respondents[0] }
      - "judicial_district1": ${ trial_court.judicial_district }
      - "filing_parish1": ${ trial_court.name }
      - "user_domicile": ${ users[0].address.county.replace(" Parish", "") }
      - "respondent_domicile1": ${ respondents[0].address.county.replace(" Parish", "") }
      - "marriage_year1": ${ marriage_date.year }
      - "marriage_month1": ${ marriage_date.format("MMMM") }
      - "marriage_day1": ${ ordinal_number(marriage_date.day,use_word=False) }
      - "marriage_parish": ${ marriage_parish }
      - "separation_day1": ${ ordinal_number(separation_date.day,use_word=False) }
      - "separation_month1": ${ separation_date.format("MMMM") }
      - "separation_year1": ${ separation_date.year }
      - "maiden_name1": |
          % if revert_to_maiden_name:
          ${ maiden_name1 }
          % else:
          "NOT APPLICABLE"
          % endif      
      - "user_signature": ${ users[0].signature if i == 'final' else '' }
      - "petitioner_telephone": ${ petitioner_telephone }
      - "petitioner_email": ${ petitioner_email }
      - "judicial_district2": ${ trial_court.judicial_district }
      - "filing_parish2": ${ trial_court.name }
      - "respondent_address": ${ respondents[0].address.on_one_line() }
      - "judicial_district3": ${ trial_court.judicial_district }
      - "filing_parish3": ${ trial_court.name }
      - "judicial_district4": ${ trial_court.judicial_district }
      - "filing_parish5": ${ trial_court.name }
      - "petitioner_domicile": ${ users[0].address.county.replace(" Parish", "") }
      - "respondent_domicile2": ${ respondents[0].address.county.replace(" Parish", "") }
      - "marriage_month2": ${ marriage_date.format("MMMM") }
      - "marriage_year2": ${ marriage_date.year }
      - "marriage_day2": ${ ordinal_number(marriage_date.day,use_word=False) }
      - "separation_day2": ${ ordinal_number(separation_date.day,use_word=False) }
      - "separation_month2": ${ separation_date.format("MMMM") }
      - "separation_year2": ${ separation_date.year }
      - "judicial_district5": ${ trial_court.judicial_district }
      - "filing_parish6": ${ trial_court.name }
      - "maiden_name2": |
          % if revert_to_maiden_name:
          ${ maiden_name1 }
          % else:
          "NOT APPLICABLE"
          % endif
      - "respondent_domicile1": |
          % if domiciliary_service:
          ${ respondents[0].address.county.replace(" Parish", "") }
          % else: 
          ${ home_parish }
          % endif
      - "respondent_domicile2": |
          % if domiciliary_service:
          ${ respondents[0].address.county.replace(" Parish", "") }
          % else: 
          ${ home_parish }
          % endif

